#include <fstream>
#include "json/json.hpp"
#include "neural_net.h"

using json = nlohmann::json;

int main() {
    std::ifstream i("/home/pavel/New_programs/drone_vs_clouds/net1.json");
    json j;
    i >> j;

    NeuralNet net = NeuralNet(j);

    float* output_buff = new float[net.getOutputDim()];

    float input_buff[280] = {1.49363   , 0.821713  , 0.367268  , 2.2892    , 1.65368   ,
                       0.25      , 0.184798  , 0.103315  , 1.50713   , 1.36863   ,
                       0.470588  , 0.470588  , 1.        , 1.        , 3.36973   ,
                       0.210986  , 0.139317  , 1.70956   , 0.276749  , 0.0703248 ,
                       0.0605545 , 0.162254  , 0.331228  , 0.681809  , 0.0301978 ,
                       0.0079123 , 1.46521   , 1.00929   , 1.34643   , 0.839541  ,
                       0.355052  , 2.29566   , 1.65368   , 0.25      , 0.182809  ,
                       0.0950497 , 1.50713   , 1.36863   , 0.470588  , 0.470588  ,
                       1.        , 1.        , 3.31398   , 0.212358  , 0.137845  ,
                       1.63584   , 0.262906  , 0.0670141 , 0.0589557 , 0.160158  ,
                       0.314232  , 0.647043  , 0.028686  , 0.00753653, 1.48352   ,
                       1.01653   , 1.2135    , 0.855587  , 0.344057  , 2.30105   ,
                       1.65368   , 0.25      , 0.181135  , 0.0872187 , 1.50713   ,
                       1.36863   , 0.470588  , 0.470588  , 1.        , 1.        ,
                       3.25061   , 0.212839  , 0.13633   , 1.56356   , 0.24972   ,
                       0.0638286 , 0.0572946 , 0.15768   , 0.298108  , 0.614029  ,
                       0.0272462 , 0.00717551, 1.49669   , 1.01969   , 1.10432   ,
                       0.870029  , 0.236275  , 2.32524   , 1.77251   , 0.25      ,
                       0.180288  , 0.0956466 , 1.4276    , 1.02732   , 0.470588  ,
                       0.470588  , 1.        , 1.        , 3.17997   , 0.212469  ,
                       0.145666  , 1.49239   , 0.238172  , 0.0607688 , 0.0555453 ,
                       0.153724  , 0.283883  , 0.589225  , 0.0258755 , 0.00682919,
                       1.50472   , 1.01893   , 1.00395   , 0.883026  , 0.228709  ,
                       2.3475    , 1.77251   , 0.25      , 0.180112  , 0.0999732 ,
                       1.4276    , 1.02732   , 0.470588  , 0.470588  , 1.        ,
                       1.        , 3.10353   , 0.211305  , 0.151702  , 1.42283   ,
                       0.227026  , 0.0578338 , 0.0537015 , 0.149007  , 0.270227  ,
                       0.564653  , 0.0245712 , 0.00649738, 1.50765   , 1.01448   ,
                       0.911866  , 0.894723  , 0.221899  , 2.36798   , 1.77251   ,
                       0.25      , 0.180474  , 0.101228  , 1.4276    , 1.02732   ,
                       0.470588  , 0.470588  , 1.        , 1.        , 3.02254   ,
                       0.209415  , 0.155303  , 1.35523   , 0.21629   , 0.0550222 ,
                       0.0517707 , 0.143943  , 0.257136  , 0.540468  , 0.0233303 ,
                       0.00617983, 1.50559   , 1.00656   , 0.840544  , 0.905251  ,
                       0.        , 2.4       , 1.72095   , 0.25      , 0.182319  ,
                       0.107392  , 1.36267   , 0.878875  , 0.470588  , 0.470588  ,
                       1.        , 1.        , 2.93722   , 0.206872  , 0.189453  ,
                       1.2895    , 0.205205  , 0.0523316 , 0.0497188 , 0.13841   ,
                       0.246799  , 0.524223  , 0.0221502 , 0.00587622, 1.49871   ,
                       0.995435  , 0.773243  , 0.914726  , 0.        , 2.43006   ,
                       1.72095   , 0.25      , 0.185316  , 0.109846  , 1.36267   ,
                       0.878875  , 0.470588  , 0.470588  , 1.        , 1.        ,
                       2.84889   , 0.203752  , 0.209268  , 1.22596   , 0.194687  ,
                       0.0497594 , 0.047555  , 0.13276   , 0.236548  , 0.506932  ,
                       0.0210281 , 0.00558619, 1.48724   , 0.98139   , 0.710047  ,
                       0.923253  , 0.        , 2.45824   , 1.72095   , 0.25      ,
                       0.189185  , 0.109547  , 1.36267   , 0.878875  , 0.470588  ,
                       0.470588  , 1.        , 1.        , 2.75862   , 0.200126  ,
                       0.220728  , 1.1648    , 0.184707  , 0.0473024 , 0.0453184 ,
                       0.127187  , 0.22645   , 0.488978  , 0.0199614 , 0.00530934,
                       1.47143   , 0.964716  , 0.650955  , 0.930928  , 0.        ,
                       2.48461   , 1.72095   , 0.25      , 0.193694  , 0.107248  ,
                       1.36267   , 0.878875  , 0.470588  , 0.470588  , 1.        ,
                       1.        , 2.66727   , 0.196066  , 0.226688  , 1.10614   ,
                       0.175237  , 0.0449573 , 0.043066  , 0.121802  , 0.216557  ,
                       0.470661  , 0.0189477 , 0.00504525, 1.45159   , 0.945713  };

    net.process(input_buff,output_buff);

    float result = output_buff[0];
    delete [] output_buff;
    return 0;
}
